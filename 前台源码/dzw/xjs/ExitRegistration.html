<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>离职登记</title>
		<link rel="stylesheet" href="css/bootstrap.min.css" />
		 <!-- 最新版本的 Bootstrap 核心 CSS 文件 -->
		 <link rel="stylesheet" href="https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
		
		 <!-- 可选的 Bootstrap 主题文件（一般不用引入） -->
		 <link rel="stylesheet" href="https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
		<style type="text/css">
			.text-right{
				margin-top: 30px;
			}
			.clear1{
				display: block;
				content: '';
				clear: both;
			}
			.title {
				font-size: 26px;
				margin-left: 10px;
			}
			.table1{
				width: 95%;
			}
			.table2{
				width: 70%;
			}
			.headDiv{
				background-color:ghostwhite;
				width: 100%;
				height:80px;
			}
			.headDiv_left {
				font-size: 26px;
				margin: 20px 30px;
				height: 40px;
				line-height: 40px;
				float: left;
			}
			.headDiv_right{
				float: right;
				height: 40px;
				line-height: 40px;
				margin: 20px 30px;
			}
			.search{
				width: 350px;
				height: 40px;
				line-height: 40px;
				outline: none;
				margin-left: 100px;
			}
			.btn{
				height: 40px;
				line-height: 40px;
				text-align: center;
				padding: 0px 12px;
				margin-left: 10px;
			}
			.buttonMenus{
				/*margin-top: 20px;*/
				margin-right: 20px;
				background-color:whitesmoke;
				text-align: right;			
			}
			.bodyDiv{
				width: 100%;
				background-color: ghostwhite
			}
			.table th{
				color: white;
				background-color: deepskyblue;
				border: 1px solid black;
			}
			.table td{
				border: 1px solid gray;
			}
			body{
				width: 100%;
				height: 100%;
				margin: 0px;
				padding: 0px;
				background-color: ghostwhite
			}
			#selByDiv{
				/*border: 0px solid red;width: 100%;margin: 20px auto;height: auto;display:none;*/
			}
			.selByDiv{
				width: 100%;
			}
			.form-inline{
				width: 80%;
				height: auto;
				border: 1px solid blue;
				margin: 20px auto;
			}
			.form-control1{
				width: 835px;
				height: 34px;
			    padding: 6px 12px;
			    font-size: 14px;
			    line-height: 1.42857143;
			    color: #555;
			    background-color: #fff;
			    background-image: none;
			    border: 1px solid #ccc;
			    border-radius: 4px;
			    outline: none;
			}
			#lzdj{
				/*border: 1px solid red;width: 80%;height: auto;margin: 20px auto;display:none;*/
			}
			#xzyg{
				/*border: 1px solid red;width: 70%;height: auto;margin: 10px auto;display: none;*/
			}
			#storeLogin{
				/*border: 1px solid red;width: 60%;height: auto;margin: 20px auto;display: none;*/
			}
			.centerButton{
				/*margin-left: 40px;*/
				width: 100px;
				height: 40px;
				line-height: 40px;
			}
			.title{
				height: 40px;
				line-height: 40px;
			}
			ul,li{
				list-style: none;
			}
			.jg_centernDiv{
				margin-top: 20px;
			}
			.jg_bottonDiv{
				display: flex;margin-top: 20px;
			}
			.jg_bottonDiv_div1{
				width: 30%;
			}
			.jg_bottonDiv_div2{
				width: 70%;
			}
			#jgDiv{
				/*border: 1px solid red;width: 80%;height: auto;margin: 20px auto;display: none;*/
			}
			.modal-dialog{
				width: 80%;
			}
			.modal-dialog1{
				    -webkit-transform: translate(0,0);
				    -ms-transform: translate(0,0);
				    -o-transform: translate(0,0);
				    transform: translate(0,0);
				    width: 70%;
				    margin: 20px auto;
			}
			.bg{
				background: orchid;
			}
		</style>
	</head>
	<body>
		<div id="ctx">
			<div class="clear1 headDiv">
				<div class="headDiv_left">离职登记</div>
				<div class="headDiv_right">
				<input type="text" class="search" placeholder="匹配工号/姓名/手机" id="search"/>
				<button class="btn btn-success" @click="sel">
					<span class="glyphicon glyphicon-search" aria-hidden="true"></span>
					搜索
				</button>
				<button class="btn btn-danger">
					<span class="glyphicon glyphicon-off" aria-hidden="true"></span>
					关闭
				</button>
				</div>
			</div>
			<div class="bodyDiv">
				<div class="buttonMenus">
					<button class="btn"@click="openStoreChoose">
						<span class="glyphicon glyphicon-random" aria-hidden="true"></span>
						门店选择
					</button>
					<button class="btn btn-danger" @click="openFireLogin">
						<span class="glyphicon glyphicon-plus" aria-hidden="true"></span>
						离职登记
					</button>
					<button class="btn btn-danger" @click="huiGun">
						<span class="glyphicon glyphicon-repeat" aria-hidden="true"></span>
						回滚
					</button>
					<button class="btn btn-info">
						<span class="glyphicon glyphicon-inbox" aria-hidden="true"></span>
						打开
					</button>
					<button class="btn btn-danger" @click="remove">
						<span class="glyphicon glyphicon-trash" aria-hidden="true"></span>
						删除
					</button>
					<button class="btn btn-info" @click="openSel">
						<span class="glyphicon glyphicon-search" aria-hidden="true"></span>
						查询
					</button>
					<button class="btn btn-default" @click="daoChu">
						<span class="glyphicon glyphicon-floppy-save" aria-hidden="true"></span>
						导出
					</button>
				</div>
				<div>
					<table class="table table2">
						<tr>
							<th></th>
							<th>部门</th>
							<th>员工编号</th>
							<th>姓名</th>
							<th>性别</th>
							<th>职位</th>
							<th>离职日期</th>
							<th>离职原因</th>
						</tr>
						<tr v-for="item,index in list" :class='{bg:index==isactive}' @click="fn(index)">
							<td></td>
							<td @click="chooseYgTr(item)" v-if="item.department">{{item.department.dName}}</td>
							<td v-else></td>
							<td @click="chooseYgTr(item)">{{item.eId}}</td>
							<td @click="chooseYgTr(item)">{{item.name}}</td>
							<td @click="chooseYgTr(item)">{{item.sex}}</td>
							<td @click="chooseYgTr(item)" v-if="item.job">{{item.job.jobName}}</td>
							<td v-else></td>
							<td @click="chooseYgTr(item)">{{item.dismissDate}}</td>
							<td @click="chooseYgTr(item)">{{item.dismissReason}}</td>
						</tr>
					</table>
				</div>
			</div>
			<div>
				合计:<span>{{a}}</span>条记录
			</div>
			<!--查询条件div-->
			<!--员工查询 -->
			<div class="modal" data-backdrop = "static" id="selByDiv">
				<div class="modal-dialog">
					<div class="modal-content">
						<div class="modal-header">
							<h3 class="col-lg-offset-1 col-lg-4">员工查询</h3>
							<div class="text-right">
								<button class="btn btn-success" @click="selByDiv">
									<span class="glyphicon glyphicon-ok" aria-hidden="true"></span>
									确定
								</button>
								<button class="btn btn-danger" @click="closeSel">
									<span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
									关闭
								</button>
							</div>
						</div>
						<div class="modal-body">
							<table border="0" cellspacing="0" cellpadding="0" width="100%" height="auto">
								<tr>
									<td colspan="4">
										<div class="form-group">
											<label class="control-label">员工编号</label>
											<input type="text" name="" id="" value="" class="form-control" v-model="departrueQw.eId"/>
										</div>
									</td>
									<td colspan="4">
										<div class="form-group">
											<label class="control-label">员工姓名</label>
											<input type="text" name="" id="" value="" class="form-control" v-model="departrueQw.name"/>
										</div>
									</td>
									<td colspan="4">
										<div class="form-group">
											<label for="" class="control-label">性别</label>
											<input type="text" name="" id="" value="" class="form-control" v-model="departrueQw.sex" />
										</div>
									</td>
								</tr>
								<tr>
									<td colspan="6">
										<div class="form-group">
											<label class="control-label">岗位</label>
											<select class="form-control" v-model="departrueQw.jobId">
												<option value="">总经理</option>
												<option value="">副总经理</option>
											</select>
										</div>
									</td>
									<td colspan="6">
										<div class="form-group">
											<label class="control-label">部门</label>
											<input type="text" name="" id="" value="" readonly="readonly" class="form-control" v-model="departrueQw.dId" @click="opendepartDiv"/>			
										</div>
									</td>
								</tr>
								<tr>
									<td colspan="4">
										<div class="form-group">
											<label class="control-label">身体状态</label>
											<input type="text" id="" value="" class="form-control" />
										</div>
									</td>
									<td colspan="4">
										<div class="form-group">
											<label class="control-label">身高</label>
											<input type="text" id="" value="" class="form-control" />
										</div>
									</td>
									<td colspan="4">
										<div class="form-group">
											<label class="control-label">籍贯</label>
											<input type="text" id="" value="" class="form-control"/>
										</div>
									</td>
								</tr>
								<tr>
									<td colspan="4">
										<div class="form-group">
											<label class="control-label">民族</label>
											<input type="text" id="" value=""  class="form-control"/>
										</div>
									</td>
									<td colspan="4">
										<div class="form-group">
											<label class="control-label">婚姻状态</label>
											<input type="text" id="" value="" class="form-control"/>
										</div>
									</td>
									<td colspan="4">
										<div class="form-group">
											<label class="control-label">学历</label>
											<select class="form-control">
												<option value="">大专</option>
												<option value="">本科</option>
											</select>
										</div>
									</td>
								</tr>
								<tr>
									<td colspan="4">
										<div class="form-group">
											<label class="control-label">毕业学校</label>
											<input type="text" id="" value="" class="form-control" />
										</div>
									</td>
									<td colspan="4">
										<div class="form-group">
											<label class="control-label">专业</label>
											<select class="form-control">
												<option value="">计算机科学</option>
												<option value="">网络工程</option>
											</select>
										</div>
									</td>
									<td colspan="4">
										<div>
											<label class="control-label">专业资格</label>
											<input type="text" id="" value="" class="form-control"/>
										</div>
									</td>
								</tr>
								<tr>
									<td colspan="4">
										<div class="form-group">
											<label class="control-label">生日</label>
											<input type="date" id="" value="" class="form-control"/>
										</div>
									</td>
									<td colspan="4">
										<div class="form-group">
											<label class="control-label">学位</label>
											<input type="text" id="" value="" class="form-control"/>
										</div>
									</td>
									<td colspan="4">
										<div class="form-group">
										 	<label class="control-label">编制</label>
											<input type="text" id="" value="" class="form-control"/>
										</div>
									</td>
								</tr>
								<tr>
									<td colspan="6">
										<div class="form-group">
											<label class="control-label">身份证号</label>
											<input type="text" id="" value="" class="form-control"/>
										</div>
									</td>
									<td colspan="6">
										<div class="form-group">
											<label class="control-label">入职日期从</label>
											<input type="date" id="" value="" class="form-control"/>
											<label class="control-label">至</label>
											<input type="date" id="" value="" class="form-control"/>
										</div>
									</td>
								</tr>
								<tr>
									<td colspan="6">
										<div class="form-group">
											<label class="control-label">试用日期从</label>
											<input type="date" id="" value="" class="form-control"/>
											<label class="control-label">至</label>
											<input type="date" id="" value="" class="form-control"/>
										</div>
									</td>
									<td colspan="6">
										<div class="form-group">
											<label class="control-label">属性</label>
											<select class="form-control">
												<option value="">记考勤计薪</option>
												<option value="">不记考勤计薪</option>
												<option value="">记考勤不计薪</option>
												<option value="">不记考勤不计薪</option>
											</select>
										</div>
									</td>
								</tr>
								<tr>
									<td colspan="6">
										<div class="form-group">
											<label class="control-label">合同开始从</label>
											<input type="date" id="" value="" class="form-control"/>
											<label class="control-label">至</label>
											<input type="date" id="" value="" class="form-control"/>
										</div>
									</td>
								</tr>
							</table>
						</div>
						<div class="modal-footer"></div>
					</div>
				</div>
			</div>
			<!--离职登记-->
			 <div class="modal" data-backdrop = "static" id="lzdj">
				<div class="modal-dialog">
					<div class="modal-content">
						<div class="modal-header">
							<h3 class="col-lg-offset-1 col-lg-3">离职登记</h3>
							<div class="text-right">
								<button class="btn btn-success" @click="fireLogin">
									<span class="glyphicon glyphicon-ok" aria-hidden="true"></span>
									确定
								</button>
								<button class="btn btn-danger" @click="closeFireLogin">
									<span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
									关闭
								</button>
							</div>
						</div>
						<div class="modal-body">
							<form class="form-inline">
								<div class="form-group">
									<label class="control-label">员工姓名</label>
									<input type="text" name="" id="" class="form-control"  readonly="readonly" v-model="exit.eId"/>
									<input type="text" name="" id="" value="" class="form-control" readonly="readonly" v-model="exit.name"/>
									<a class="btn" @click="openChooseEploy">
										<span class="glyphicon glyphicon-star" aria-hidden="true"></span>
										选择员工
									</a>
									<a class="btn" @click="openJgDiv">
										<span class="glyphicon glyphicon-star-empty" aria-hidden="true"></span>
										选择技工
									</a>
									<label class="control-label">离职日期</label>
									<input type="date" name="" id="" value=""class="form-control" v-model="exit.dismissDate" />
								</div>
								<div class="form-group">
									<label class="control-label">离职原因</label>
									<input type="text" name="" id="" value="" class="form-control1" width="85%" v-model="exit.dismissReason"/>
								</div>
							</form>
						</div>
						<div class="modal-footer"></div>
					</div>
				</div>
			</div>
			<!--选择员工-->
			 <div class="modal" data-backdrop id="xzyg">
				<div class="modal-dialog1">
					<div class="modal-content">
						<div class="modal-header">
							<h3 class="col-lg-offset-1 col-lg-3">选择员工</h3>
							<div class="text-right">
								<button class="btn btn-success" @click="chooseEploy">
									<span class="glyphicon glyphicon-ok" aria-hidden="true"></span>
									确定
								</button>
								<button class="btn btn-danger" @click="closeChooseEploy">
									<span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
									关闭
								</button>
							</div>
						</div>
						<div class="modal-body">
							<select name="" class="form-control" v-model="employ.mId" @change="selEmply" @blur="selAllDepartment">
								<option value=""></option>
								<option v-for="item in storeList" :value="item.storeId">{{item.storeName}}</option>
							</select>
							<select class="form-control" v-model="employ.dId" @change="selEmply">
								<option value="">所有</option>
								<option v-for="item in departmentList" :value="item.dId">{{item.dName}}</option>
							</select>
							<table border="" cellspacing="" cellpadding="" class="table table1">
								<tr>
									<th>部门</th>
									<th>工号</th>
									<th>姓名</th>
								</tr>
								<tr v-for="(item,index) in yg"  :class='{bg:index==isactive}' @click="fn(index)">
									<td  @click="chooseEmployTableTr(item)">{{item.department.dName}}</td>
									<td  @click="chooseEmployTableTr(item)">{{item.eId}}</td>
									<td  @click="chooseEmployTableTr(item)">{{item.eName}}</td>
								</tr>
							</table>
						</div>
						<div class="modal-footer"></div>
					</div>
				</div>
			 </div>
			<!--门店选择-->
			 <div class="modal" data-backdrop = "static" id="storeLogin">
				<div class="modal-dialog">
					<div class="modal-content">
						<div class="modal-header">
							<h3 class="col-lg-offset-1 col-lg-3">门店选择</h3>
							<div class="text-right">
								<input type="text" name="" id="searchStore" placeholder="匹配门店编码/门店" class="search"/>
								<button class="btn btn-success" @click="searchStore">
									<span class="glyphicon glyphicon-search" aria-hidden="true"></span>
									搜索
								</button>
								<button class="btn btn-danger" @click="closeStoreChoose">
									<span class="glyphicon glyphicon-off" aria-hidden="true"></span>
									关闭
								</button>
							</div>
						</div>
						<div class="modal-body">
							<div class="text-right">
								<button class="btn btn-success" @click="storeChoose">
									<span class="glyphicon glyphicon-ok" aria-hidden="true"></span>
									确定
								</button>
								<button class="btn btn-primary" @click="checkAllStore(true)">
									<span class="glyphicon glyphicon-sort-by-attributes" aria-hidden="true"></span>
									全部选择
								</button>
								<button class="btn btn-primary" @click="checkAllStore(false)">
									<span class="glyphicon glyphicon-sort-by-attributes-alt" aria-hidden="true"></span>
									全部取消
								</button>
							</div>
							<table border="" cellspacing="" cellpadding="" class="table table1">
								<tr>
									<th></th>
									<th>选择</th>
									<th>门店代码</th>
									<th>门店名称</th>
									<th>所属城市</th>
								</tr>
								<tr v-for="item in storeList">
									<td></td>
									<td>
										<input type="checkbox" id="" :value="item.storeId" v-model="storeChecks" />
									</td>
									<td>{{item.storeId}}</td>
									<td>{{item.storeName}}</td>
									<td></td>
								</tr>
							</table>
						</div>
						<div class="modal-footer"></div>
					</div>
				</div>
			</div>
			<!--选择技工-->
			<div class="modal" data-backdrop id="jgDiv">
				<div class="modal-dialog1">
					<div class="modal-content">
						<div class="modal-header">
							<h3 class="col-lg-offset-1 col-lg-2">班组技工</h3>
							<button class="btn btn-success centerButton" @click="chooseJg">
								<span class="glyphicon glyphicon-ok" aria-hidden="true"></span>
								确定
							</button>
							<input type="text" name="" id="searchJg" value="" class="search" placeholder="匹配工号/姓名/手机"/>
							<button class="btn btn-default" @click="searchWorkMan">
								<span class="glyphicon glyphicon-search" aria-hidden="true"></span>
								搜索
							</button>
							<button class="btn btn-danger" @click="closeJgDiv">
								<span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
								关闭
							</button>
						</div>
						<div class="modal-body">
							<div class="jg_centernDiv">
								<button class="btn btn-info">
									<span class="glyphicon glyphicon-search" aria-hidden="true"></span>
									查询
								</button>
							</div>
						<div class="jg_bottonDiv">
								<!--左侧树状-->
								<div class="jg_bottonDiv_div1">
									<ul>
										<li v-for="item in tuandui"  @click.stop="select_bj($event)">{{item.tdName}}
												<ul>
													<li @click.stop="select_bj_school($event)" v-for="i in item.tfList" @click="bz(i.jgList,i.teamCode,i.teamName,i)">{{i.teamName}}</li>
												</ul>
										</li>
									</ul>
								</div>
								<!--右侧表格-->
								<div class="jg_bottonDiv_div2">
									<table border="" cellspacing="" cellpadding="" class="table table1">
										<tr>
											<th></th>
											<td>班组编号</td>
											<td>班组名称</td>
											<td>技工编号</td>
											<td>技工姓名</td>
											<td>性别</td>
											<td>是否是组长</td>
											<td>手机</td>
										</tr>
										<tr v-for="(item,index) in jgList" :class='{bg:index==isactive}' @click="fn(index)">
											<td @click="chooseTechnicalTableTr(item)"></td>
											<td v-if="item.core != null"  @click="chooseTechnicalTableTr(item)">{{item.core}}</td>
											<td v-else  @click="chooseTechnicalTableTr(item)">{{jgList.core}}</td>
											<td v-if="item.name != null"  @click="chooseTechnicalTableTr(item)">{{item.name}}</td>
											<td v-else  @click="chooseTechnicalTableTr(item)">{{jgList.name}}</td>
											<td  @click="chooseTechnicalTableTr(item)">{{item.technicalNumber}}</td>
											<td  @click="chooseTechnicalTableTr(item)">{{item.technicalName}}</td>
											<td  @click="chooseTechnicalTableTr(item)">{{item.technicalSex}}</td>
											<td v-if="item.headman == true"  @click="chooseTechnicalTableTr(item)">是</td>
											<td v-else  @click="chooseTechnicalTableTr(item)">否</td>
											<td  @click="chooseTechnicalTableTr(item)">{{item.phone}}</td>
										</tr>
									</table>
								</div>
						</div>
						</div>
						<div class="modal-footer"></div>
					</div>
				</div>
			</div>
			 <!-- 部门框-->
             <div class="modal" data-backdrop = "static" id="departDiv">
				<div class="modal-dialog1">
					<div class="modal-content">
						<div class="modal-header">
							<h3 class="col-lg-4">部门选择</h3>
		            		<div class="text-right">
		            			<button class="btn btn-success" @click="savedepartList">
									<span class="glyphicon glyphicon-ok" aria-hidden="true"></span>
									选择
								</button>
								<button class="btn btn-danger" @click="closedepartDiv">
									<span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
									关闭
								</button>
		            		</div>
						</div>
						<div class="modal-body">
							<div>
			            		<select name="" class="form-control" v-model="selStoorId" @change="getDepartmentList(selStoorId)">
			            			<option :value="item.storeId" v-for="item in storeList">{{item.storeId}}-{{item.storeName}}</option>
			            			<!--<option value="">0001-成高</option>
			            			<option value="">0002-成高1</option>-->
			            		</select>
			            	</div>
			            	<div>
			            		<table border="" cellspacing="" cellpadding="" class="table table2">
			            			<tr>
			            				<th></th>
			            				<th>部门编码</th>
			            				<th>部门名称</th>
			            				<th>部门分类</th>
			            			</tr>
			            			<tr v-for="(item,index) in departList" :class='{bg:index==isactive}' @click="fn(index)">
			            				<td  @click="chooseDepartmentTr(item)"></td>
			            				<td  @click="chooseDepartmentTr(item)">{{item.dId}}</td>
			            				<td  @click="chooseDepartmentTr(item)">{{item.dName}}</td>
			            				<td  @click="chooseDepartmentTr(item)">{{item.departmentType.tName}}</td>
			            			</tr>
			            		</table>
			            	</div>
						</div>
						<div class="modal-footer"></div>
					</div>
				</div>
			</div>
		</div>
	</body>
	<script type="text/javascript" src="js/jquery-1.12.4.js" ></script>
	<script type="text/javascript" src="js/bootstrap.min.js" ></script>
	<script type="text/javascript" src="js/vue.js" ></script>
	<script type="text/javascript">
		new Vue({
			el:"#ctx",
			data(){
				return{
					//员工list
					yg:[],
					list:[],
					storeChecks:[],
					//门店假数据
					storeList:[{
						id:"0000",
						name:"总厂",
						city:""
					},{
						id:"0001",
						name:"成高",
						city:"北京市"
					}],
					//班组模拟数据
					/*bz:[{
						id:10,
						name:"自建",
						children:[{
							id:1000,
							name:"机修1组"
						},{
							id:1001,
							name:"机修2组"
						},{
							id:1004,
							name:"机电1组"
						}]
					},{
						id:11,
						name:"联队",
						children:[{
							id:1002,
							name:"华山队"
						}]
					},{
						id:12,
						name:"加盟",
						children:[{
							id:1003,
							name:"武昌队"
						}]
					}],*/
					//门店部门条件对象
					employ:{},
					//部门list
					departmentList:[],
					//离职登记对象
					exit:{},
					//操作的员工行
					checkedEclos:{},
					isactive:0,
					//统计表格个数
					a:0,
					//操作离职的员工或者技工编号
					changeEid:"",
					//离职查询条件对象
					departrueQw:{},
					//团队(班组)
					tuandui:[],
					//技工list
					jgList:[],
					//操作的技工行
					checkTclos:{},
					selStoorId:"",
					departList:[],
					updateOrAddDepartment:{}
				}
			},
			methods:{
				//条件查询方法
				sel(){
					var parse = $("#search").val();
					if(parse==null||parse==""){
						this.find();
						return;
					}
					console.log(parse);
					let that=this;
					$.ajax({
						url:"http://127.0.0.1:8080/departure/selByEidOrName/"+parse,
						dataType:"json",
						type:"get",
						xhrFields: {
							withCredentials: true
						},
						crossDomain: true,
						async:false,
						success:function(result){
							that.list=result;
							that.a=that.list.length;
						}
					});
					alert("正在进行条件查询");
				},
				huiGun(){
					var flag=window.confirm("你确定要将该员工复职么?");
					if(flag){
						if(this.changeEid==null||this.changeEid==""){
							alert("请先选择要操作的列");
							return;
						}
						let that=this;
						$.ajax({
							url:"http://127.0.0.1:8080/departure/employBack/"+that.changeEid,
							type:"put",
							xhrFields: {
								withCredentials: true
							},
							crossDomain: true,
							async:false,
							success:function(result){
								if(result){
									alert("回滚成功");
								}else{
									alert("回滚失败");
								}
							}
						});
					}
					this.find();
				},
				remove(){
					var flag1 =window.confirm("你确定要将该员工删除么？该员工所有信息都将被删除");
					if(flag1){
						if(this.changeEid==null||this.changeEid==""){
							alert("请先选择要操作的列");
							return;
						}
						let that=this;
						$.ajax({
							url:"http://127.0.0.1:8080/departure/remove/"+that.changeEid,
							type:"delete",
							xhrFields: {
								withCredentials: true
							},
							crossDomain: true,
							async:false,
							success:function(result){
								if(result){
									alert("删除成功");
								}else{
									alert("删除失败");
								}
							}
						});
					}
					this.find();
				},
				daoChu(){
					var eList=[];
					this.list.forEach(
						item=>{eList.push(item.eId);
					});
					console.log(eList);
					var json=JSON.stringify(eList);
					var lzList=eList.toString();
					console.log(lzList);
					window.location.href="http://127.0.0.1:8080/departure/downLoadExportExcel?lzList="+lzList;
					/*alert("导出成功");*/
				},
				//查询所有离职人员
				find(){
					let that =this;
					$.ajax({
						url:"http://127.0.0.1:8080/departure/selAll",
						dataType:"json",
						type:"get",
						xhrFields: {
							withCredentials: true
						},
						crossDomain: true,
						async:false,
						success:function(result){
							console.log(result);
							that.list=result;
							that.a=that.list.length;
						}
					});
				},
				openSel(){
					$("#selByDiv").modal("show");
				},
				closeSel(){
					$("#selByDiv").modal("hide");
				},
				//查询按钮
				selByDiv(){
					let that=this;
					if(that.departrueQw==null){
						alert("123");
						this.find();
						return;
					}
					/*alert("正在进行条件div查询");*/
					var json=JSON.stringify(that.departrueQw);
					console.log(json);
					$.ajax({
						url:"http://127.0.0.1:8080/departure/selBySearch",
						data:json,
						dataType:"json",
						type:"post",
						xhrFields: {
							withCredentials: true
						},
						crossDomain: true,
						async:false,
						contentType:"application/json;charset=utf-8",
						success:function(result){
							that.list=result;
							that.a=that.list.length;
						}
					});
					$("#selByDiv").modal("hide");
				},
				//打开离职登记
				openFireLogin(){
					$("#lzdj").modal("show");
				},
				//关闭离职登记
				closeFireLogin(){
					$("#lzdj").modal("hide");
				},
				//离职登记
				fireLogin(){
					if(this.exit.eId==null||this.exit.eId==""){
						alert("离职员工编号不能为空!");
						return;
					}
					var json=JSON.stringify(this.exit);
					console.log(json);
					$.ajax({
						url:"http://127.0.0.1:8080/departure",
						data:json,
						type:"post",
						xhrFields: {
							withCredentials: true
						},
						crossDomain: true,
						async:false,
						contentType:"application/json;charset=utf-8",
						success:function(result){
							if(result){
								alert("离职登记成功");
							}else{
								alert("离职登记失败");
							}
						}
					});
					$("#lzdj").modal("hide");
					this.find();
				},
				//打开选择员工
				openChooseEploy(){
					this.selAllStore();
					this.selEmply();
					$("#xzyg").modal("show");
				},
				closeChooseEploy(){
					$("#xzyg").modal("hide");
				},
				//将选中的员进行录入
				chooseEploy(){
					if(this.checkedEclos==""||this.checkedEclos==null){
						alert("请先选择员工");
						return;
					}
					this.exit={};
					this.exit.eId=this.checkedEclos.eId;
					this.exit.name=this.checkedEclos.eName;
					this.exit.sex=this.checkedEclos.sex.sexName;
					this.exit.dId=this.checkedEclos.dId;
					this.exit.sId=this.checkedEclos.mId;
					this.exit.jobId=this.checkedEclos.jId;
					console.log(this.exit);
					/*Vue.set(this.exit,"eId",this.checkedEclos.eId);*/
					alert("正在将选择的员工填入");
					$("#xzyg").modal("hide");
				},
				//门店选择
				openStoreChoose(){
					this.selAllStore();
					$("#storeLogin").modal("show");
				},
				closeStoreChoose(){
					$("#storeLogin").modal("hide");
				},
				//选择门店进行门店条件查询
				storeChoose(){
					alert("已选中这些门店，将对这些门店作为条件进行离职登记查询");
					this.selBySid();
					$("#storeLogin").modal("hide");
				},
				//全选门店或者全部取消
				checkAllStore(c){
					if(!c){
						 alert("取消全选");
						 this.storeChecks=[];
					}else{
						alert("全选");
						this.storeChecks= this.storeList.map(item=>item.storeId);
					}
				},
				//对门店进行查询
				searchStore(){
					var parse = $("#searchStore").val();
					if(parse==null||parse==''){
						this.selAllStore();
						return;
					}
					let that=this;
					$.ajax({
						url:"http://127.0.0.1:8080/store/selStoreFuzzy/"+parse,
						dataType:"json",
						type:"get",
						xhrFields: {
							withCredentials: true
						},
						crossDomain: true,
						async:false,
						success:function(result){
							console.log(result);
							that.storeList=result;
							console.log(that.storeList);
						}
					});
					/*alert("1122");*/
					/*$("#storeLogin").modal("hide");
					$("#storeLogin").modal("show");*/
					alert("正在按条件查询门店");
				},
				//搜索框查询
				searchWorkMan(){
					
					alert("正在根据搜索框内容进行员工条件查询");
				},
				//打开离职技工窗口
				openJgDiv(){
					this.findTuanDui();
					/*this.shux();*/
					this.bzFind();
					$("#jgDiv").modal("show");
				},
				closeJgDiv(){
					$("#jgDiv").modal("hide");
				},
				//将技工离职登记
				chooseJg(){
					if(this.checkTclos==""||this.checkTclos==null){
						alert("请先选择技工");
						return;
					}
					this.exit={};
					this.exit.eId=this.checkTclos.technicalNumber;
					this.exit.sex=this.checkTclos.technicalSex;
					this.exit.name=this.checkTclos.technicalName;
					this.exit.sId=1;
					console.log(this.exit);
					/*Vue.set(this.exit,"eId",this.checkTclos.technicalNumber);*/
					alert("正在讲该技工进行录入");
					$("#jgDiv").modal("hide");
				},
				//根据门店和部门查询员工
				selEmply(){
					let that=this;
					var json=JSON.stringify(this.employ);
					console.log(json);
					$.ajax({
						url:"http://127.0.0.1:8080/employees/selByMidAndDid",
						type:"post",
						data:json,
						dataType:"json",
						xhrFields: {
							withCredentials: true
						},
						crossDomain: true,
						async:false,
						contentType:"application/json;charset=utf-8",
						success:function(result){
							console.log(result);
							that.yg=result;
						}
					});
				},
				selAllStore(){
					let that=this;
					$.ajax({
						url:"http://127.0.0.1:8080/store",
						type:"get",
						dataType:"json",
						xhrFields: {
							withCredentials: true
						},
						crossDomain: true,
						async:false,
						success:function(result){
							console.log(result);
							that.storeList=result;
						}
					});
				},
				//根据门店查询所有部门
				selAllDepartment(){
					var sId=this.employ.mId;
					if(sId==""||sId==null){
						sId=1;
					}
					let that=this;
					console.log(sId);
					$.ajax({
						url:"http://127.0.0.1:8080/department/findBySid/"+sId,
						type:"get",
						dataType:"json",
						xhrFields: {
							withCredentials: true
						},
						crossDomain: true,
						async:false,
						success:function(result){
							console.log(result);
							that.departmentList=result;
						}
					});
				},
				//选中员工行
				chooseEmployTableTr(item){
					this.checkedEclos=item;
					console.log(this.checkedEclos);
				},
				//选中技工行
				chooseTechnicalTableTr(item){
					this.checkTclos=item;
					console.log(this.checkTclos);
				},
				  //点击tr背景变色
                fn (index) {
					      //点击切换 变量的值 赋值为 index
					      this.isactive=index;
				},
				//门店筛选查询
				selBySid(){
					let that =this;
					console.log(that.storeChecks);
					$.ajax({
						url:"http://127.0.0.1:8080/departure/selBySid",
						type:"post",
						data:JSON.stringify(that.storeChecks),
						dataType:"json",
						contentType: "application/json;charset=UTF-8",
						xhrFields: {
							withCredentials: true
						},
						crossDomain: true,
						async:false,
						success:function(result){
							console.log(result);
							that.list=result;
							that.a=that.list.length;
						}
					});
				},
				//将选择的离职员工编号录入用于回滚及删除
				chooseYgTr(item){
					this.changeEid=item.eId;
					console.log(this.changeEid);
				},
				//团队list填充
				findTuanDui(){
					let that=this;
					$.ajax({
						url:"http://127.0.0.1:8080/tuandui/find",
						success:function(result){
							that.tuandui=result;
						}
					});
				},
				//
				bz(list,code,name,TeamForm){
						this.updateTeamFrom = TeamForm;
						this.jgVisble = true;
						this.bzVisble = true;
						let that = this;
						list.core = code;
						list.name = name;
						console.log(this.jgList);
						this.jgList = list;
				},
				//
				findByLike(){
						let that = this;
						$.ajax({
							url:"http://127.0.0.1:8080/tuandui/findByLike",
							data:{
								condition:that.findLike
							},
							type:"post",
							success:function(result){
								console.log(result);
								that.jgList = result;
							}
						}) 
				},
				//
				xgjgUpdate(item){
						this.xgjgVisble = true;
						this.updatejg = item;
				},
				//
				select_bj(e){
					$(e.target).find("ul").toggleClass("hide");
					console.log(this.tuandui);
				},
				select_bj_school(e){
					$(e.target).find("ul").toggleClass("hide");
				},
				/*shux(){
					this.clasM=this.gongsi1;
				},*/
				//查询所有班组
				bzFind(){
					let that = this;
					$.ajax({
					    url:"http://127.0.0.1:8080/teamForm/bzFind",
						dataType:"json",
						success:function(result){
						console.log(result);
						that.bzList = result;
						}
					})
				},
				//将选择的部门填入
               	savedepartList(){
               			if(this.updateOrAddDepartment==null||this.updateOrAddDepartment==""){
               				alert("请先选择部门");
               				return;
               			}
               			this.departrueQw={};
               			this.departrueQw.dId=this.updateOrAddDepartment.dId;
               			alert("正在将选择的部门填入");
               			$("#departDiv").modal("hide");
               	},
               	//打开部门框子
               	opendepartDiv(){
               			this.getAllDepartmentList();
               			this.getStoreList();
               			$("#departDiv").modal("show");
               	},
               	closedepartDiv(){
               			$("#departDiv").modal("hide");
               	},
               	 //获取所有门店
                   getStoreList(){
                   	 let that=this;
                   	 $.ajax({
                    		url:"http://127.0.0.1:8080/store",
                    		type:"get",
                    		dataType:"json",
                    		xhrFields: {
							withCredentials: true
							},
							crossDomain: true,
							success:function(result){
								 console.log(result);
								that.storeList=result;
							}
                    	});
                   },
                   //获取当前门店的部门
                   getDepartmentList(mId){
                   	 let that=this;
                   	 $.ajax({
                    		url:"http://127.0.0.1:8080/department/findBySid/"+mId,
                    		type:"get",
                    		dataType:"json",
                    		xhrFields: {
							withCredentials: true
							},
							crossDomain: true,
							 async:false,
							success:function(result){
								 console.log(result);
								that.departList=result;
							}
                    	});
                   },
                   //获取所有部门
                   getAllDepartmentList(){
                   	   let that=this;
                   	   $.ajax({
                   	   	url:"http://127.0.0.1:8080/department/findAllDepartment",
                   	   	type:"get",
                   	   	xhrFields: {
							withCredentials: true
						},
						crossDomain: true,
						 async:false,
                   	   	dataType:"json",
                   	   	success:function(result){
                   	   		console.log(result);
                   	   		that.departList=result;
                   	   	}
                   	   });
                   },
                    chooseDepartmentTr(item){
                    	this.updateOrAddDepartment=item;
                    }
			},
			created(){
				this.employ={};
				this.yg=[];
				this.find();
				this.bzFind();
				/*this.shux();*/
				this.findTuanDui();
			}
		});
	</script>
</html>
