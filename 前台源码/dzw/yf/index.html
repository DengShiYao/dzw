<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title></title>
    <!-- 引入样式 -->
    <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
    <link rel="stylesheet" href="../css/bootstrap.min.css">
    <style>
        .el-menu-vertical-demo:not(.el-menu--collapse) {
            width: 220px;
            height: 100%;
        }

        .el-menu-vertical-demo {
            height: 100%;
        }

        .el-menu {
            border-right: 0px;
        }

        html,
        body {
            height: 100%;
            margin: 0px;
        }

        .sectionmin {
            padding: 0px 10px 10px;
            border-left: 2px solid red;
            border-top: 1px solid red;
        }

        .headerstyle {
            padding-left: 10px;
            height: 56px !important;
            background: linear-gradient(to right, rgb(84, 92, 100), #84817a);
            line-height: 59px;
        }

        .adminimg img {
            border-radius: 20px;
            width: 40px;
        }

        .adminimg>img,
        .adminimg>span {
            vertical-align: middle;
        }




        .scrollContent::-webkit-scrollbar-track-piece {
            background-color: #FFFFFF;
        }

        /*滚动条整体部分*/
        .scrollContent::-webkit-scrollbar {
            width: 10px;
            height: 10px;
        }

        /*滚动条里面的小方块，能向上向下移动*/
        .scrollContent::-webkit-scrollbar-thumb {
            background-color: #bfbfbf;
            border-radius: 5px;
            border: 1px solid #F1F1F1;
            box-shadow: inset 0 0 6px rgba(0, 0, 0, .3);
        }

        /*滚动条的轨道*/
        .scrollContent::-webkit-scrollbar-track {
            /* -webhit-box-shadow: inset 0 0 5px transparent; */
            background-color: transparent !important;
            background-color: #FFFFFF;
        }

        .scrollContent::-webkit-scrollbar-thumb:hover {
            background-color: #A8A8A8;
        }

        .scrollContent::-webkit-scrollbar-thumb:active {
            background-color: #787878;
        }

        /*边角，即两个滚动条的交汇处*/
        .scrollContent::-webkit-scrollbar-corner {
            background-color: #FFFFFF;
        }

        body,
        html {
            margin: 0px;
            padding: 0px;
            height: 100%;
            color: white;
        }

        a {
            color: white;
        }

        #ctn {
            height: 100%;
            width: 100%;
            border: 2px solid #e3e3e3;
        }

        iframe {
            background-color: white;
        }

        .nav {
            margin-left: 20px;
        }

        .row>div:nth-child(1) {
            border-right: 1px solid #e3e3e3;
        }

        .a,
        #a {
            padding: 0px;
            margin: 0px;
        }

        iframe {
            width: 100%;
            height: 600px;
            border: 0px;
        }

        .tabclose {
            position: absolute;
            top: 0px;
            right: 0px;
        }
    </style>

</head>

<body>
    <script src="http://unpkg.com/vue/dist/vue.js"></script>
    <script src="http://unpkg.com/element-ui@2.15.1/lib/index.js"></script>
    <script src="js/menu.js"></script>
    <script src="js/jquery-1.12.4.js"></script>
    <!-- <script src="js/vue-2.6.js"></script> -->
    <script src="js/bootstrap.js"></script>
    <div id="app" style="height: 100%;">
        <el-container style="height: 100%;">
            <el-aside style="width: auto;background-color: #636e72;color: #ffffff;" class="scrollContent">
                <el-menu default-active="2" class="el-menu-vertical-demo" @open="handleOpen" :collapse="isCollapse"
                    @close="handleClose" background-color="#545c64" text-color="#fff" active-text-color="#ffd04b">
                    <el-menu-item index="6" @click="toUnfoldAndFold">
                        <i :class="isCollapseIcon"></i> <!-- <i class="el-icon-s-fold"></i> -->
                        <span slot="title" style="font-size: 20px;"><strong>德召文卡修系统</strong></span>
                    </el-menu-item>
                    <el-submenu v-bind:index="item.menuId+'-'+index+1" v-for="item,index in menu">
                        <template slot="title">
                            <i class="el-icon-location"></i>
                            <span>{{item.menuName}}</span>
                        </template>
                        <tree :menu="item.sysMenuC" :index1="index+1" @create-tab="createTab"></tree>
                    </el-submenu>

                </el-menu>
            </el-aside>
            <el-container>
                <el-header class="headerstyle">
                    <el-row :gutter="24">
                        <el-col :span="18" :offset="0">
                            <div class="col-md-11">
                                <ul class="nav nav-tabs" style="padding-left: 65px;">
                                    <li role="presentation" v-for="item in menuM"><a href="#"
                                            @click="find_MenuC(item.menuId)">{{item.menuName}}</a></li>
                                </ul>
                            </div>
                        </el-col>
                        <el-col :span="3" :offset="2">
                            <div class="grid-content bg-purple ">
                                <el-dropdown>
                                    <div class="adminimg">
                                        <span> <strong style="color: #ffffff;">超级管理员</strong></span>
                                        <img src="../imags/3AA159DD714F65B532595C955DEB5356.jpg" alt="">
                                    </div>
                                    <!-- <el-button type="primary">
                                    </el-button> -->
                                    <el-dropdown-menu slot="dropdown">
                                        <el-dropdown-item>黄金糕</el-dropdown-item>
                                        <el-dropdown-item>狮子头</el-dropdown-item>
                                        <el-dropdown-item>螺蛳粉</el-dropdown-item>
                                        <el-dropdown-item>双皮奶</el-dropdown-item>
                                        <el-dropdown-item>蚵仔煎</el-dropdown-item>
                                    </el-dropdown-menu>
                                </el-dropdown>
                            </div>
                        </el-col>
                    </el-row>
                </el-header>
                <el-main class="sectionmin">
                    <el-row>
                        <el-col :span="24">
                            <div class="grid-content bg-purple-dark">
                                <el-tag closable class="el-tag" @close="handleCloseTag(tag)" v-for="tag in tabs"
                                    :key="tag.column1" :type="tag.type">
                                    <a :href="'#'+tag.column1" style="color:black;"
                                        data-toggle="tab">{{tag.menuName}}</a>
                                </el-tag>
                            </div>
                        </el-col>
                    </el-row>
                    <el-row>
                        <el-col :span="24" class="tab-content">
                            <div v-for="item in tabs" class="grid-content bg-purple-dark tab-content"
                                style="height:609px;" :class="['tab-pane',item.active?'active':'']" :id="item.column1">
                                <!-- scrolling="no" -->
<<<<<<< HEAD
                                <iframe :src="item.url" width="100%" height="100%" frameborder="no" border="0"></iframe>
=======
                                <!-- <iframe src="commodity_info.html" width="100%" height="100%" frameborder="no"
                                    border="0"></iframe> -->
>>>>>>> 1895a0b66508be8a53d0589dae9ba73797ddedc8
                            </div>
                        </el-col>
                    </el-row>
                </el-main>
            </el-container>
        </el-container>
    </div>
    <!-- <script:::: src="js/vue-2.6.js" type="text/javascript" charset="utf-8"></script::::> -->

    <script>
        Vue.component("tree", {
            props: ["menu", "index1"],
            template: `	
                <el-menu-item-group >
                    <el-menu-item v-for="item,index in menu" @click="createTab(item)" v-bind:index="item.menuId+'-'+index1+'-'+index+1"  >{{item.menuName}}
                        <tree :menu="item.sysMenuC,index1" :index1="index+1"  @create-tab="createTab" ></tree>
                    </el-menu-item>
                </el-menu-item-group>
		`,
            methods: {
                createTab(item) {
                    this.$emit("create-tab", item);
                }
            }
        })
        var perms = [];
        menuApi.findPerms(function(result){
            perms=result;
        });
        var basePath = "http://127.0.0.1:8080/";
        var Main = {
            data() {
                return {
                    menuM: {},
                    menu: {},
                    isCollapse: false,
                    isCollapseIcon: "el-icon-s-fold",
                    tabs: [
                        { id: 0, menuName: "首页", column1: "index", active: true, path: "首页信息.html" }
                    ]
                };
            },
            methods: {
                handleOpen(key, keyPath) {
                    console.log(key, keyPath);
                },
                handleClose(key, keyPath) {
                    console.log(key, keyPath);
                },
                //标签页的关闭
                handleCloseTag(tag) {
                    this.tabs.forEach((item, index) => {
                        if (index == this.tabs.length - 1) {
                            this.tabs[index - 1].active = true;
                        }
                        if (item.column1 == tag.column1) {
                            this.tabs.splice(index, 1);
                        }

                    });
                },
                /* 左侧树形展开折叠 */
                toUnfoldAndFold() {
                    this.isCollapse = this.isCollapse ? false : true;
                    this.isCollapseIcon = this.isCollapse ? "el-icon-s-unfold" : "el-icon-s-fold";
                },
                toTagSwitch() {

                },
                // 查询主菜单
                find_Menu() {
                    let that = this;
                    $.ajax({
                        url: basePath + "sysMenu",
                        type: "post",
                        async: false,
                        xhrFields: {
                            withCredentials: true
                        },
                        crossDomain: true,
                        dataType: "JSON",
                        success: function (result) {
                            that.menuM = result;
                        }
                    })
                },
                //
                find_MenuC(menuId) {
                    let that = this;
                    $.ajax({
                        url: basePath + "sysMenu/" + menuId,
                        type: "post",
                        async: false,
                        xhrFields: {
                            withCredentials: true
                        },
                        crossDomain: true,
                        dataType: "JSON",
                        success: function (result) {
                            that.menu = [];
                            that.menu = result;
                        }
                    })
                },
                //创建标签叶
                createTab(item) {
                    if (item.sysMenuC && item.sysMenuC.length > 0) {
                        return;
                    }
                    this.tabs.forEach(item => { item.active = false; });
                    this.$set(item, "active", true);
                    var filterItem = this.tabs.filter(sitem => sitem.column1 == item.column1);
                    if (filterItem && filterItem.length > 0) {
                        this.$set(filterItem[0], "active", true);
                    } else {
                        console.log(item);
                        this.tabs.push(item);
                    }
                },
            },
            created() {
                this.find_Menu();
                this.find_MenuC(1);
            }
        }
        var Ctor = Vue.extend(Main)
        new Ctor().$mount('#app')
    </script>


</body>

</html>