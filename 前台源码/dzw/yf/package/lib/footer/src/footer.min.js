"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _ctor=_interopRequireDefault(require("xe-utils/ctor")),_tools=require("../../tools");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _defineProperty(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}var cellType="footer";function mergeFooterMethod(e,t,o){for(var l=0;l<e.length;l++){var r=e[l],n=r.row,a=r.col,c=r.rowspan,i=r.colspan;if(-1<a&&-1<n&&c&&i){if(n===t&&a===o)return{rowspan:c,colspan:i};if(n<=t&&t<n+c&&a<=o&&o<a+i)return{rowspan:0,colspan:0}}}}var _default={name:"VxeTableFooter",props:{footerData:Array,tableColumn:Array,fixedColumn:Array,fixedType:String,size:String},mounted:function(){var e=this.$parent,t=this.$el,o=this.$refs,l=this.fixedType,r=e.elemStore,n="".concat(l||"main","-footer-");r["".concat(n,"wrapper")]=t,r["".concat(n,"table")]=o.table,r["".concat(n,"colgroup")]=o.colgroup,r["".concat(n,"list")]=o.tfoot,r["".concat(n,"xSpace")]=o.xSpace},render:function(O){var e=this._e,A=this.$parent,D=this.fixedType,t=this.fixedColumn,M=this.tableColumn,X=this.footerData,j=A.$listeners,o=A.tId,l=A.footerRowClassName,q=A.footerCellClassName,r=A.footerRowStyle,N=A.footerCellStyle,R=A.footerAlign,U=A.mergeFooterList,V=A.footerSpanMethod,z=A.align,B=A.scrollXLoad,H=A.columnKey,K=A.showFooterOverflow,W=A.currentColumn,Y=A.overflowX,n=A.scrollbarWidth,G=A.tooltipOpts;return U.length&&V||(D&&K?M=t:B&&D&&(M=t)),O("div",{class:["vxe-table--footer-wrapper",D?"fixed-".concat(D,"--wrapper"):"body--wrapper"],attrs:{xid:o},on:{scroll:this.scrollEvent}},[D?e():O("div",{class:"vxe-body--x-space",ref:"xSpace"}),O("table",{class:"vxe-table--footer",attrs:{xid:o,cellspacing:0,cellpadding:0,border:0},ref:"table"},[O("colgroup",{ref:"colgroup"},M.map(function(e,t){return O("col",{attrs:{name:e.id},key:t})}).concat(n?[O("col",{attrs:{name:"col_gutter"}})]:[])),O("tfoot",{ref:"tfoot"},X.map(function(P,k){var E=k;return O("tr",{class:["vxe-footer--row",l?_ctor.default.isFunction(l)?l({$table:A,_rowIndex:k,$rowIndex:E,fixed:D,type:cellType}):l:""],style:r?_ctor.default.isFunction(r)?r({$table:A,_rowIndex:k,$rowIndex:E,fixed:D,type:cellType}):r:null},M.map(function(t,e){var o,l=t.type,r=t.showFooterOverflow,n=t.footerAlign,a=t.align,c=t.footerClassName,i=G.showAll||G.enabled,s=t.children&&t.children.length,f=D?t.fixed!==D&&!s:t.fixed&&Y,d=_ctor.default.isUndefined(r)||_ctor.default.isNull(r)?K:r,u=n||a||R||z,p="ellipsis"===d,x="title"===d,v=!0===d||"tooltip"===d,m=x||v||p,g={colid:t.id},y={},b=A.getColumnIndex(t),_=A.getVTColumnIndex(t),h={$table:A,_rowIndex:k,$rowIndex:E,column:t,columnIndex:b,$columnIndex:e,_columnIndex:_,itemIndex:_,items:P,fixed:D,type:cellType,data:X};if(B&&!m&&(p=m=!0),(x||v||i)&&(y.mouseenter=function(e){x?_tools.DomTools.updateCellTitle(e.currentTarget,t):(v||i)&&A.triggerFooterTooltipEvent(e,h)}),(v||i)&&(y.mouseleave=function(e){(v||i)&&A.handleTargetLeaveEvent(e)}),j["footer-cell-click"]&&(y.click=function(e){A.emitEvent("footer-cell-click",Object.assign({cell:e.currentTarget},h),e)}),j["footer-cell-dblclick"]&&(y.dblclick=function(e){A.emitEvent("footer-cell-dblclick",Object.assign({cell:e.currentTarget},h),e)}),U.length){var w=mergeFooterMethod(U,k,_);if(w){var T=w.rowspan,$=w.colspan;if(!T||!$)return null;1<T&&(g.rowspan=T),1<$&&(g.colspan=$)}}else if(V){var C=V(h)||{},I=C.rowspan,S=void 0===I?1:I,F=C.colspan,L=void 0===F?1:F;if(!S||!L)return null;1<S&&(g.rowspan=S),1<L&&(g.colspan=L)}return O("td",{class:["vxe-footer--column",t.id,(o={},_defineProperty(o,"col--".concat(u),u),_defineProperty(o,"col--".concat(l),l),_defineProperty(o,"col--last",e===M.length-1),_defineProperty(o,"fixed--hidden",f),_defineProperty(o,"col--ellipsis",m),_defineProperty(o,"col--current",W===t),o),_tools.UtilTools.getClass(c,h),_tools.UtilTools.getClass(q,h)],attrs:g,style:N?_ctor.default.isFunction(N)?N(h):N:null,on:y,key:H?t.id:e},[O("div",{class:["vxe-cell",{"c--title":x,"c--tooltip":v,"c--ellipsis":p}]},t.renderFooter(O,h))])}).concat(n?[O("td",{class:"vxe-footer--gutter col--gutter"})]:[]))}))])])},methods:{scrollEvent:function(e){var t=this.$parent,o=this.fixedType,l=t.$refs,r=t.scrollXLoad,n=t.triggerScrollXEvent,a=t.lastScrollLeft,c=l.tableHeader,i=l.tableBody,s=l.tableFooter,f=l.validTip,d=c?c.$el:null,u=s?s.$el:null,p=i.$el,x=u?u.scrollLeft:0,v=x!==a;t.lastScrollLeft=x,t.lastScrollTime=Date.now(),d&&(d.scrollLeft=x),p&&(p.scrollLeft=x),r&&v&&n(e),v&&f&&f.visible&&f.updatePlacement(),t.emitEvent("scroll",{type:cellType,fixed:o,scrollTop:p.scrollTop,scrollLeft:x,isX:v,isY:!1},e)}}};exports.default=_default;